<!DOCTYPE html>
<html>
<head>
    <title>Result Page</title>
    <meta charset="UTF-8">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="css/styleforresult.css"> 
    
</head>
<script>
    var lylic,chord,detail,album;
    document.addEventListener("DOMContentLoaded", function () {
        getData();
      });
      function getData(){
        let url = window.location.href
        console.log(url)
        let data=url.split("/")[3];
        let sname=data.split("?")[1];
        let sbrand=data.split("?")[2];
        let ssolo=data.split("?")[3];
        sname_a = sname.replace('%20',' ')
        sbrand_a = sbrand.replace('%20',' ')
        ssolo_a = ssolo.replace('%20',' ')

        $.ajax({
            type: 'POST',
            url: 'http://localhost:8888/Result',
            dataType: 'json',
            data: {
                sname_a: sname_a,
                sbrand_a: sbrand_a,
                ssolo_a: ssolo_a,
                action: 'post'
            },
            success: function (json) {
                    console.log(json)
                    $.each(json, function( index, value ) {
                        document.getElementById("name").innerHTML = sname_a;
                        
                        if(sbrand_a != '-'){
                            
                            document.getElementById("brand_name").innerHTML = value.song_brand;
                            
                        }else{
                            document.getElementById("brand").innerText = 'Solo Musician :'
                            document.getElementById("brand_name").innerHTML = value.song_solo_musician;
                        }
                        document.getElementById("type").innerHTML = value.song_type_song;
                        let pdate = value.song_produced_date.split("T")[0];
                        document.getElementById('pdate').innerHTML = pdate;
                        
                        if(value.song_photo != null){
                            document.getElementById('cover').src = value.song_photo;
                        }else{
                            document.getElementById('cover').src = "https://raw.githubusercontent.com/Drive-Sound/Drive-Sound/project_p3/Drive%20sound/web%20project/public/images/cover%20song/cover.jpg";
                        }
                        if(value.song_detail != null){
                            detail = value.song_detail;
                        }else{
                            detail= "null";
                        }
                        document.getElementById('detail').innerHTML = detail;
                        if(value.song_chord != null){
                            chord = value.song_chord;
                        }else{
                            chord= "null";
                        }
                        if(value.song_lyric != null){
                            lylic = value.song_lyric;
                        }else{
                            lylic = "null";
                        }
                        if(value.song_album != null){
                            album = value.song_album;
                        }else{
                            album = "null";
                        }
                        
                }) 
                
            },
            error: function (data) {
                alert('data.responseJSON.error');
            }
        });
    }



function openchord(){
    console.log(chord)
    let output = `<h2>Chord</h2>`;
    if(chord != "null"){
        output += `
                    <p>
                        <br><img id = "chord" src = "`+chord+`" width="100%" style = "width: 465px;" height="auto">
                        <br><hr>        
                    </p>`
    }else{
        output += `
                    <p>
                        <br><a>No Data Yet !!!</a>
                        <br><br><br><br><br><hr>
                    </p>`
    }

    document.getElementById("detail_section").innerHTML = output;
}
function opendetail(){
    let output = `<h2>Detail</h2>`;
    if(detail != "null"){
        output += `
                    <p>
                        <br><a id = "detail" >`+detail+`</a>
                        <br><br><br><br><br><hr>
                    </p>`
    }else{
        output += `
                    <p>
                        <br><a>No Data Yet !!!</a>
                        <br><br><br><br><br><hr>
                    </p>`
    }
    document.getElementById("detail_section").innerHTML = output;
}
function openlylic(){
    let output = `<h2>Lyric</h2>`;
    if(lylic != "null"){
        output += `
                    <p>
                        <br><img id = "lyric" src = "`+lylic+`" width="100%" style = "width: 465px;" height="auto">
                        <br><hr>
                    </p>`
    }else{
        output += `
                    <p>
                        <br><a>No Data Yet !!!</a>
                        <br><br><br><br><br><hr>
                    </p>`
    }
    document.getElementById("detail_section").innerHTML = output;
}
function openalbum(){
    let output = `<h2>Album</h2>`;
    if(album != "null"){
        output += `
                    <p>
                        <br><a id = "album" >`+album+`</a>
                        <br><br><br><br><br><hr>
                    </p>`
    }else{
        output += `
                    <p>
                        <br><a>No Data Yet !!!</a>
                        <br><br><br><br><br><hr>
                    </p>`
    }
    document.getElementById("detail_section").innerHTML = output;
}
</script>
<body>
    <header class ="header">
        <a href="/Home"><img src="images/Logo_DriveSound-01.png" width="100px%"></a>
    <nav class ="nav">
        <a href="/Search">Search</a>
        <a href="/About_Us">About Us</a>
        <a href="/Account">Account</a>
        <a href="/logout">Logout</a>
    </nav>
    </header>
    <div class ="container">
        <div class="row">
            <div class="column-left">
                <div class="card">
                    <div class ="img-cover">
                        <br>
                        <img id = "cover" src = "" width="100%" style = "width: 180px;" height="auto">
                    </div>
                </div>
            </div>
            <div class="column-mid">
                <div class="card">
                    <h1 id ="name"></h1>
                    <hr>
                    <p>Produced on <a id ="pdate"></a></p>
                    <p>Rating : &#11088;&#11088;&#11088;&#11088; (140) </p>
                    <div id =" element">
                        <p id="brand" style="display: inline;">Brand :</p>
                        <a id = "brand_name" style="display: inline;" ></a> 
                    </div>
                    <p>Type : <a id ="type" ></a></p>
                    <hr>
                    <div class = "col-mid-upper-nav" >
                        <nav>
                            <br>
                            <a class="btn" onclick="opendetail()" >Detail</a>
                            <a class="btn" onclick="openchord()">Chord</a>
                            <a class="btn" onclick="openlylic()">Lyric</a>
                            <a class="btn" onclick="openalbum()">Album</a>
                        </nav>
                     </div>
                     <div class = "container_bot">
                        <div id ="detail_section">
                            <h2>Detail</h2>
                            <p>
                                <br><a id = "detail" ></a>
                                <br><br><br><br><br><hr>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="column-right">
                <div class="card">
                    <li><a  >Listened</a></li><br>
                    <li><a >Like</a></li><br>
                    <li><a >Add to List</a></li>
                </div>
                <div class ="next-page">
                    <a class="button" role="button" ><span class="text">Next Song</span></a>
                </div>
            </div>
        </div>
    </div>
    

</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js"></script>
</html>